set follow-fork-mode child

python
import sys
sys.path.insert(0, '/home/kaien/local/gdb_stl')
from libstdcxx.v6.printers import register_libstdcxx_printers
#register_libstdcxx_printers (None)
end

define dumpstlht
  set $s = $arg0._M_ht._M_buckets._M_impl._M_start
  set $e = $arg0._M_ht._M_buckets._M_impl._M_finish
  set $b = 0
  while $s < $e 
    set $x = *$s
    while $x != 0
      printf "bucket %d\n", $b
      p $x->_M_val
      set $x = $x->_M_next
    end
    set $b = $b + 1
    set $s = $s + 1
  end
end

define dumphmap
  dumpstlht $arg0
end


define dumphset
  dumpstlht $arg0
end
